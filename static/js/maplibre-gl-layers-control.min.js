"use strict";(()=>{const g=`
.layers-control {
  position: relative;
  display: flex;
  align-items: flex-start;
}

.layers-control .panel {
  position: absolute;
  z-index: 1000;
  display: none;
  flex-direction: column;
  background: white;
  padding: 8px;
  border: 1px solid rgba(0, 0, 0, 0.2);
  min-width: 250px;
  max-height: 700px;
  overflow-y: auto;
  overflow-x: auto;
}

.panel-title {
  font-size: 18px;
  font-weight: bold;
  text-align: center;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

.maplibregl-ctrl-top-left > .layers-control .panel,
.maplibregl-ctrl-top-right > .layers-control .panel {
  top: 100%;
}

.maplibregl-ctrl-bottom-left > .layers-control .panel,
.maplibregl-ctrl-bottom-right > .layers-control .panel {
  bottom: 100%;
}

.maplibregl-ctrl-top-left > .layers-control .panel,
.maplibregl-ctrl-bottom-left > .layers-control .panel {
  left: 0;
}

.maplibregl-ctrl-top-right > .layers-control .panel,
.maplibregl-ctrl-bottom-right > .layers-control .panel {
  right: 0;
}

.layers-control.open .panel {
  display: flex;
}

.layers-toggle-btn {
  width: 40px;
  height: 40px;
  background-color: #fff;
  /*border: none;*/
  cursor: pointer;
  background-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M296.5 69.2C311.4 62.3 328.6 62.3 343.5 69.2L562.1 170.2C570.6 174.1 576 182.6 576 192C576 201.4 570.6 209.9 562.1 213.8L343.5 314.8C328.6 321.7 311.4 321.7 296.5 314.8L77.9 213.8C69.4 209.8 64 201.3 64 192C64 182.7 69.4 174.1 77.9 170.2L296.5 69.2zM112.1 282.4L276.4 358.3C304.1 371.1 336 371.1 363.7 358.3L528 282.4L562.1 298.2C570.6 302.1 576 310.6 576 320C576 329.4 570.6 337.9 562.1 341.8L343.5 442.8C328.6 449.7 311.4 449.7 296.5 442.8L77.9 341.8C69.4 337.8 64 329.3 64 320C64 310.7 69.4 302.1 77.9 298.2L112 282.4zM77.9 426.2L112 410.4L276.3 486.3C304 499.1 335.9 499.1 363.6 486.3L527.9 410.4L562 426.2C570.5 430.1 575.9 438.6 575.9 448C575.9 457.4 570.5 465.9 562 469.8L343.4 570.8C328.5 577.7 311.3 577.7 296.4 570.8L77.9 469.8C69.4 465.8 64 457.3 64 448C64 438.7 69.4 430.1 77.9 426.2z"/></svg>');
  background-repeat: no-repeat;
  background-position: center;
}

.layer-group {
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

.layers-control .panel::-webkit-scrollbar {
  width: 6px;
}

.layers-control .panel::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 3px;
}

.layer-name-label {
  font-size: 16px;
  margin-left: 4px;
}

.opacity-row input[type="range"] {
  width: 95%;
}

`,c={title:"Layers Control",customLabels:{},legendServiceUrl:void 0,opacityControl:!1};class m{constructor(t){this.title=t.title??c.title,this.customLabels=t.customLabels??c.customLabels,this.legendServiceUrl=t.legendServiceUrl,this.opacityControlOption=t.opacityControl??c.opacityControl}injectStyles(){if(document.getElementById("layers-control-styles"))return;const t=document.createElement("style");t.id="layers-control-styles",t.textContent=g,document.head.appendChild(t)}createToggleButton(){this.toggleBtn=document.createElement("button"),this.toggleBtn.className="maplibregl-ctrl-icon layers-toggle-btn",this.toggleBtn.type="button",this.toggleBtn.title=this.title,this.toggleBtn.setAttribute("aria-label","Mostrar capas"),this.toggleBtn.addEventListener("click",()=>{this.container.classList.toggle("open")}),this.container.appendChild(this.toggleBtn)}getBaseLayerIds(){return this.map.getStyle().layers?.filter(t=>t.metadata?.isbaselayer).map(t=>t.id)??[]}buildPanel(){this.panel.innerHTML=`<h2 class='panel-title'>${this.title}</h2>`,(this.map.getStyle().layers??[]).slice().reverse().forEach(a=>{const{id:r,type:e,metadata:o}=a,n=this.customLabels[r]??o?.alias??r,l=document.createElement("div");l.className="layer-group",e==="raster"&&o?.isbaselayer?this.radioButtonControlAdd(r,n,l):this.checkBoxControlAdd(r,n,l),this.opacityControlOption&&this.rangeControlAdd(r,e,l),this.legendServiceUrl&&this.fetchAndRenderLegend(r,l),this.panel.appendChild(l)})}radioButtonControlAdd(t,a,r){const e=this.getBaseLayerIds(),o=e[0],n=document.createElement("input");n.type="radio",n.name="base-layer",n.id=t,t===o?(n.checked=!0,this.map.setLayoutProperty(t,"visibility","visible")):this.map.setLayoutProperty(t,"visibility","none"),n.addEventListener("change",()=>{e.forEach(i=>{const s=i===t;this.map.setLayoutProperty(i,"visibility",s?"visible":"none");const d=document.getElementById(i);d&&(d.checked=s)})});const l=document.createElement("label");l.htmlFor=t,l.className="layer-name-label",l.textContent=a,r.append(n,l)}checkBoxControlAdd(t,a,r){const e=document.createElement("input");e.type="checkbox",e.id=t;const o=this.map.getLayoutProperty(t,"visibility")==="visible";e.checked=o,this.map.setLayoutProperty(t,"visibility",o?"visible":"none"),e.addEventListener("change",l=>{const i=l.target.checked;this.map.setLayoutProperty(t,"visibility",i?"visible":"none")});const n=document.createElement("label");n.htmlFor=t,n.className="layer-name-label",n.textContent=a,r.append(e,n)}rangeControlAdd(t,a,r){const e=document.createElement("div");e.className="opacity-row";const o=document.createElement("input");o.type="range",o.min="0",o.max="100";let n;a!=="symbol"?n=`${a}-opacity`:n="text-opacity";const l=Number(this.map.getPaintProperty(t,n));o.value=isNaN(l)?"100":String(Math.round(l*100)),o.addEventListener("input",i=>{const s=Number(i.target.value)/100;this.map.setPaintProperty(t,n,s)}),e.append(o),r.append(e)}async fetchAndRenderLegend(t,a){const r=new URL(this.legendServiceUrl);r.searchParams.set("layer_id",t),r.searchParams.set("has_label","false"),r.searchParams.set("include_raster","true");const e=document.createElement("div");e.className="legend-svg",e.textContent="Cargando\u2026",a.appendChild(e);try{const o=await fetch(r.toString());if(!o.ok)throw new Error(String(o.status));const n=await o.text();e.innerHTML=n}catch(o){e.textContent=`Error leyenda: ${o}`,e.style.color="red"}}onAdd(t){return this.map=t,this.injectStyles(),this.container=document.createElement("div"),this.container.className="maplibregl-ctrl layers-control",this.createToggleButton(),this.panel=document.createElement("div"),this.panel.className="panel",this.container.appendChild(this.panel),t.on("load",()=>this.buildPanel()),this.container}onRemove(){this.container.parentNode?.removeChild(this.container),this.map=void 0}getDefaultPosition(){return"top-left"}}(function(p){p.LayersControl=m})(window);var h=m;})();
//# sourceMappingURL=maplibre-gl-layers-control.min.js.map
